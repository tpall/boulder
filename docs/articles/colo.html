<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Colorectal cancer incidence and mortality • boulder</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113924774-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">boulder</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/colo.html">Colorectal cancer incidence and mortality</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tpall/boulder">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Colorectal cancer incidence and mortality</h1>
                        <h4 class="author">Taavi Päll</h4>
            
            <h4 class="date">2018-02-11</h4>
          </div>

    
    
<div class="contents">
<p>The aim of the vignette is to give some basic idea about the workflow when accessing TAI datasets <a href="http://pxweb.tai.ee/PXWeb2015/index_en.html">Estonian Health Statistics and Health Research</a> (TAI) via <code>boulder</code> package.</p>
<div id="download-list-of-available-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#download-list-of-available-datasets" class="anchor"></a>Download list of available datasets</h2>
<p>Data tables available on TAI database are listed in the data frame generated by <code><a href="../reference/get_all_tables.html">get_all_tables()</a></code> function. By default, datasets table is loaded from a local copy supplied with the package (<code>local = TRUE</code>). Set argument <code>local = FALSE</code> to download fresh list of tables from TAI.</p>
<p>Table columns <strong>Database</strong> and <strong>Node</strong> describe table address in the database tree. Database names are available only in Estonian.</p>
<ul>
<li>
<strong>Name</strong> column contains table names and should be used when downloading data.</li>
<li>
<strong>Title</strong> columns contains table descriptions and in many cases also what are the values presented in the table (e.g. age-adjusted incidence per 100’000).</li>
</ul>
<p><strong>Updated</strong> and <em>url</em> contain date of the last update and data table url, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(stringr)
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(viridis)
<span class="kw">library</span>(boulder)
tabs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_all_tables.html">get_all_tables</a></span>(<span class="dt">lang =</span> <span class="st">"en"</span>)
tabs
<span class="co">#&gt; # A tibble: 1,688 x 6</span>
<span class="co">#&gt;    Database    Node                         Name  Title    Updated  url   </span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;                        &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; </span>
<span class="co">#&gt;  1 01Rahvastik Abortions                    RK01  Abortio… 2017-06… http:…</span>
<span class="co">#&gt;  2 01Rahvastik Abortions                    RK11  Abortio… 2017-11… http:…</span>
<span class="co">#&gt;  3 01Rahvastik Abortions                    RK20  Abortio… 2017-06… http:…</span>
<span class="co">#&gt;  4 01Rahvastik Abortions                    RK30  Abortio… 2017-06… http:…</span>
<span class="co">#&gt;  5 01Rahvastik Abortions                    RK40  Abortio… 2017-06… http:…</span>
<span class="co">#&gt;  6 01Rahvastik Abortions                    RK50  Use of … 2017-06… http:…</span>
<span class="co">#&gt;  7 01Rahvastik Abortions                    RK61  Legally… 2017-06… http:…</span>
<span class="co">#&gt;  8 01Rahvastik Abortions                    RK62  Abortio… 2017-06… http:…</span>
<span class="co">#&gt;  9 01Rahvastik Abortions                    RK63  Abortio… 2017-06… http:…</span>
<span class="co">#&gt; 10 01Rahvastik Births and breastfed infants SR01  Live bi… 2017-10… http:…</span>
<span class="co">#&gt; # ... with 1,678 more rows</span></code></pre></div>
<p>Find tables with cancer incidence and mortality data. Table info is stored in <strong>Title</strong> column. For better matching we convert Title column to lower case.</p>
</div>
<div id="cancer-incidence" class="section level2">
<h2 class="hasAnchor">
<a href="#cancer-incidence" class="anchor"></a>Cancer incidence</h2>
<p>Cancer morbidity data is stored under <em>Malignant neoplasms</em> node.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabs <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">descr =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/case">str_to_lower</a></span>(Title)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_detect">str_detect</a></span>(descr, <span class="st">"neoplasm"</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(Name, Title, Node, Updated) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>()</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Title</th>
<th align="left">Node</th>
<th align="left">Updated</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PK10</td>
<td align="left">New cases of malignant neoplasms by specified site, sex and age group</td>
<td align="left">Malignant neoplasms</td>
<td align="left">2017-12-13T22:52:47</td>
</tr>
<tr class="even">
<td align="left">PK20</td>
<td align="left">New cases of malignant neoplasms by specified site, sex and county</td>
<td align="left">Malignant neoplasms</td>
<td align="left">2017-12-13T21:27:14</td>
</tr>
<tr class="odd">
<td align="left">PK30</td>
<td align="left">Age-specific incidence rate of malignant neoplasms per 100 000 inhabitants by site and sex</td>
<td align="left">Malignant neoplasms</td>
<td align="left">2017-12-13T22:55:51</td>
</tr>
<tr class="even">
<td align="left">PK40</td>
<td align="left">Incidence rate of malignant neoplasms per 100 000 inhabitants by specified site, sex and county</td>
<td align="left">Malignant neoplasms</td>
<td align="left">2017-12-13T21:26:14</td>
</tr>
</tbody>
</table>
<p>We are interested in table <strong>PK30</strong>: <em>Age-specific incidence rate of malignant neoplasms per 100 000 inhabitants by site and sex</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pk30 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pull_table.html">pull_table</a></span>(<span class="st">"PK30"</span>, <span class="dt">lang =</span> <span class="st">"en"</span>)
pk30
<span class="co">#&gt; # A tibble: 42,048 x 5</span>
<span class="co">#&gt;    Year  Site                              Sex   `Age group`  value</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                             &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2000  All malignant neoplasms (C00-C97) Men   0-4          18.5 </span>
<span class="co">#&gt;  2 2000  All malignant neoplasms (C00-C97) Men   5-9          12.3 </span>
<span class="co">#&gt;  3 2000  All malignant neoplasms (C00-C97) Men   10-14        11.1 </span>
<span class="co">#&gt;  4 2000  All malignant neoplasms (C00-C97) Men   15-19         7.61</span>
<span class="co">#&gt;  5 2000  All malignant neoplasms (C00-C97) Men   20-24        25.8 </span>
<span class="co">#&gt;  6 2000  All malignant neoplasms (C00-C97) Men   25-29        33.6 </span>
<span class="co">#&gt;  7 2000  All malignant neoplasms (C00-C97) Men   30-34        36.3 </span>
<span class="co">#&gt;  8 2000  All malignant neoplasms (C00-C97) Men   35-39        75.0 </span>
<span class="co">#&gt;  9 2000  All malignant neoplasms (C00-C97) Men   40-44       143   </span>
<span class="co">#&gt; 10 2000  All malignant neoplasms (C00-C97) Men   45-49       247   </span>
<span class="co">#&gt; # ... with 42,038 more rows</span></code></pre></div>
<p>Let’s see if we can find data for colon cancer incidence. Cancer anatomical site is stored under <strong>Site</strong> variable. Incidence values are available for 73 anatomical sites.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pk30 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(Site) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span>()
<span class="co">#&gt; # A tibble: 73 x 1</span>
<span class="co">#&gt;    Site                                                             </span>
<span class="co">#&gt;    &lt;chr&gt;                                                            </span>
<span class="co">#&gt;  1 All malignant neoplasms (C00-C97)                                </span>
<span class="co">#&gt;  2 All malignant neoplasms except skin (other) (C00-C97, except C44)</span>
<span class="co">#&gt;  3 Lip, oral cavity and pharynx (C00-C14)                           </span>
<span class="co">#&gt;  4 ..Lip (C00)                                                      </span>
<span class="co">#&gt;  5 ..Tongue (C01-02)                                                </span>
<span class="co">#&gt;  6 ..Gum, floor of mouth etc (C03-C06)                              </span>
<span class="co">#&gt;  7 ..Major salivary glands (C07-C08)                                </span>
<span class="co">#&gt;  8 ..Tonsil, oropharynx (C09-C10)                                   </span>
<span class="co">#&gt;  9 ..Nasopharynx (C11)                                              </span>
<span class="co">#&gt; 10 ..Piriform sinus, hypopharynx (C12-C13)                          </span>
<span class="co">#&gt; # ... with 63 more rows</span></code></pre></div>
<p>After some digging, we can see that colon cancer is nested under <em>Digestive organs (C15-C26)</em>: <em>..Colon (C18)</em>. Now we can pull out data for colon regular expression.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">colo &lt;-<span class="st"> </span>pk30 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise_all.html">mutate_at</a></span>(<span class="st">"Site"</span>, str_to_lower) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_detect">str_detect</a></span>(Site, <span class="st">"colon"</span>))
colo
<span class="co">#&gt; # A tibble: 576 x 5</span>
<span class="co">#&gt;    Year  Site          Sex   `Age group` value</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2000  ..colon (c18) Men   0-4          0   </span>
<span class="co">#&gt;  2 2000  ..colon (c18) Men   5-9          0   </span>
<span class="co">#&gt;  3 2000  ..colon (c18) Men   10-14        0   </span>
<span class="co">#&gt;  4 2000  ..colon (c18) Men   15-19        0   </span>
<span class="co">#&gt;  5 2000  ..colon (c18) Men   20-24        0   </span>
<span class="co">#&gt;  6 2000  ..colon (c18) Men   25-29        0   </span>
<span class="co">#&gt;  7 2000  ..colon (c18) Men   30-34        2.13</span>
<span class="co">#&gt;  8 2000  ..colon (c18) Men   35-39        0   </span>
<span class="co">#&gt;  9 2000  ..colon (c18) Men   40-44        6.04</span>
<span class="co">#&gt; 10 2000  ..colon (c18) Men   45-49       10.8 </span>
<span class="co">#&gt; # ... with 566 more rows</span></code></pre></div>
<p>We have incidence rates for different age groups for men and women from years 2000 to 2015. Let’s plot incidence (<code>value</code>) versus time (<code>Year</code>) to see if there are any changes in incidence rates during this time period. First we also need to convert <code>Year</code> from character to numeric and <code>Age group</code> to factor to keep its correct ordering.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">colo <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year),
         <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span> =<span class="st"> </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>, <span class="dt">levels =</span> <span class="kw">unique</span>(colo<span class="op">$</span><span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>)),
         <span class="dt">Site =</span> <span class="kw">gsub</span>(<span class="st">"^[.]+([a-z])"</span>, <span class="st">"</span><span class="ch">\\</span><span class="st">U</span><span class="ch">\\</span><span class="st">1"</span>, Site, <span class="dt">perl =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(Year, value, <span class="dt">group =</span> <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>, <span class="dt">color =</span> <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_viridis">scale_color_viridis_d</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/guides">guides</a></span>(<span class="dt">color =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/guide_legend">guide_legend</a></span>(<span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Incidence of colon (C18) cancer"</span>,
       <span class="dt">y =</span> <span class="st">"Age-specific incidence per 100 000"</span>)</code></pre></div>
<p><img src="colo_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can see that, as expected, cancer incidence is higher in older age groups (coloring) and colon cancer is generally higher in men. However, it is interesting that colon cancer incidence has been increasing in men during observed period.</p>
</div>
<div id="cancer-mortality" class="section level2">
<h2 class="hasAnchor">
<a href="#cancer-mortality" class="anchor"></a>Cancer mortality</h2>
<p>Mortality data is stored under node <em>Deaths</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabs <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">Node =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/case">str_to_lower</a></span>(Node)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_detect">str_detect</a></span>(Node, <span class="st">"deaths"</span>))
<span class="co">#&gt; # A tibble: 15 x 6</span>
<span class="co">#&gt;    Database    Node   Name  Title                Updated   url            </span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt;     &lt;chr&gt;          </span>
<span class="co">#&gt;  1 01Rahvastik deaths SD21  Deaths by cause, se… 2018-01-… http://pxweb.t…</span>
<span class="co">#&gt;  2 01Rahvastik deaths SD22  Deaths per 100 000 … 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt;  3 01Rahvastik deaths SD23  Standardised mortal… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt;  4 01Rahvastik deaths SD30  Deaths by sex, caus… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt;  5 01Rahvastik deaths SD31  15 prevalent causes… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt;  6 01Rahvastik deaths SD40  Deaths from disease… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt;  7 01Rahvastik deaths SD41  Direct drug-related… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt;  8 01Rahvastik deaths SD50  Infant deaths by se… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt;  9 01Rahvastik deaths SD501 Infant deaths by ca… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt; 10 01Rahvastik deaths SD51  Perinatal deaths by… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt; 11 01Rahvastik deaths SD52  Perinatal deaths an… 2017-06-… http://pxweb.t…</span>
<span class="co">#&gt; 12 01Rahvastik deaths SD53  Stillbirths by caus… 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt; 13 01Rahvastik deaths SD60  Amenable deaths to … 2017-11-… http://pxweb.t…</span>
<span class="co">#&gt; 14 01Rahvastik deaths SD61  Preventable deaths … 2017-05-… http://pxweb.t…</span>
<span class="co">#&gt; 15 01Rahvastik deaths DR90  Autopsies            2017-05-… http://pxweb.t…</span></code></pre></div>
<p>We are interested in table <strong>SD22</strong> titled <em>Deaths per 100 000 inhabitants by cause of death, sex and age group</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd22 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pull_table.html">pull_table</a></span>(<span class="st">"SD22"</span>, <span class="dt">lang =</span> <span class="st">"en"</span>)
sd22
<span class="co">#&gt; # A tibble: 99,960 x 5</span>
<span class="co">#&gt;    Year  `Cause of death`     Sex   `Age group`                  value</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                &lt;chr&gt; &lt;chr&gt;                        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 1989  All causes (A00-Y89) Men   Crude mortality rate        1186  </span>
<span class="co">#&gt;  2 1989  All causes (A00-Y89) Men   Standardised mortality rate   NA  </span>
<span class="co">#&gt;  3 1989  All causes (A00-Y89) Men   0                           1775  </span>
<span class="co">#&gt;  4 1989  All causes (A00-Y89) Men   1-4                          125  </span>
<span class="co">#&gt;  5 1989  All causes (A00-Y89) Men   5-9                           74.1</span>
<span class="co">#&gt;  6 1989  All causes (A00-Y89) Men   10-14                         60.0</span>
<span class="co">#&gt;  7 1989  All causes (A00-Y89) Men   15-19                        165  </span>
<span class="co">#&gt;  8 1989  All causes (A00-Y89) Men   20-24                        214  </span>
<span class="co">#&gt;  9 1989  All causes (A00-Y89) Men   25-29                        223  </span>
<span class="co">#&gt; 10 1989  All causes (A00-Y89) Men   30-34                        324  </span>
<span class="co">#&gt; # ... with 99,950 more rows</span></code></pre></div>
<p>It’s a relatively large table with 99960 rows. Let’s try to filter out colon and rectal cancer data using ICD codes. From incidence table we saw that this disease is placed under code <em>C18</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mort &lt;-<span class="st"> </span>sd22 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="st">`</span><span class="dt">Cause of death</span><span class="st">`</span> =<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/case">str_to_lower</a></span>(<span class="st">`</span><span class="dt">Cause of death</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_detect">str_detect</a></span>(<span class="st">`</span><span class="dt">Cause of death</span><span class="st">`</span>, <span class="st">"c18"</span>))
mort
<span class="co">#&gt; # A tibble: 2,352 x 5</span>
<span class="co">#&gt;    Year  `Cause of death`                     Sex   `Age group`      value</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                                &lt;chr&gt; &lt;chr&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1 1989  ....malignant neoplasm of colon and… Men   Crude mortality…  8.19</span>
<span class="co">#&gt;  2 1989  ....malignant neoplasm of colon and… Men   Standardised mo… NA   </span>
<span class="co">#&gt;  3 1989  ....malignant neoplasm of colon and… Men   0                 0   </span>
<span class="co">#&gt;  4 1989  ....malignant neoplasm of colon and… Men   1-4               0   </span>
<span class="co">#&gt;  5 1989  ....malignant neoplasm of colon and… Men   5-9               0   </span>
<span class="co">#&gt;  6 1989  ....malignant neoplasm of colon and… Men   10-14             0   </span>
<span class="co">#&gt;  7 1989  ....malignant neoplasm of colon and… Men   15-19             0   </span>
<span class="co">#&gt;  8 1989  ....malignant neoplasm of colon and… Men   20-24             0   </span>
<span class="co">#&gt;  9 1989  ....malignant neoplasm of colon and… Men   25-29             0   </span>
<span class="co">#&gt; 10 1989  ....malignant neoplasm of colon and… Men   30-34             0   </span>
<span class="co">#&gt; # ... with 2,342 more rows</span></code></pre></div>
<p>Let’s filter out data before year 2000 and keep only age groups data. Mortality is accounted separately for under 1 year old babies. Anyway, for comparison, we are mostly interested in &gt;40 year old age groups, as cancer incidence is generally very low in younger people. Filter by <code>Year</code> and <code>Age group</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">colo_mort &lt;-<span class="st"> </span>mort <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2000</span>, 
         <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span> <span class="op">%in%</span><span class="st"> </span>colo<span class="op">$</span><span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>,
         <span class="op">!</span><span class="kw">is.na</span>(value))
colo_mort
<span class="co">#&gt; # A tibble: 928 x 5</span>
<span class="co">#&gt;    Year  `Cause of death`                        Sex   `Age group` value</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;                                   &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2001  ......malignant neoplasm of colon (c18) Men   5-9          0   </span>
<span class="co">#&gt;  2 2001  ......malignant neoplasm of colon (c18) Men   10-14        0   </span>
<span class="co">#&gt;  3 2001  ......malignant neoplasm of colon (c18) Men   15-19        0   </span>
<span class="co">#&gt;  4 2001  ......malignant neoplasm of colon (c18) Men   20-24        0   </span>
<span class="co">#&gt;  5 2001  ......malignant neoplasm of colon (c18) Men   25-29        0   </span>
<span class="co">#&gt;  6 2001  ......malignant neoplasm of colon (c18) Men   30-34        0   </span>
<span class="co">#&gt;  7 2001  ......malignant neoplasm of colon (c18) Men   35-39        0   </span>
<span class="co">#&gt;  8 2001  ......malignant neoplasm of colon (c18) Men   40-44        2.02</span>
<span class="co">#&gt;  9 2001  ......malignant neoplasm of colon (c18) Men   45-49        6.47</span>
<span class="co">#&gt; 10 2001  ......malignant neoplasm of colon (c18) Men   50-54        9.49</span>
<span class="co">#&gt; # ... with 918 more rows</span></code></pre></div>
<p>Now we can create similar plot as in case of incidence:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">colo_mort <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year),
         <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span> =<span class="st"> </span><span class="kw">factor</span>(<span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>, <span class="dt">levels =</span> <span class="kw">unique</span>(colo_mort<span class="op">$</span><span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>)),
         <span class="st">`</span><span class="dt">Cause of death</span><span class="st">`</span> =<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"^[.]+([a-z])"</span>, <span class="st">"</span><span class="ch">\\</span><span class="st">U</span><span class="ch">\\</span><span class="st">1"</span>, <span class="st">`</span><span class="dt">Cause of death</span><span class="st">`</span>, <span class="dt">perl =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(Year, value, <span class="dt">group =</span> <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>, <span class="dt">color =</span> <span class="st">`</span><span class="dt">Age group</span><span class="st">`</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span><span class="st"> </span>Sex) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_viridis">scale_color_viridis_d</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/guides">guides</a></span>(<span class="dt">color =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/guide_legend">guide_legend</a></span>(<span class="dt">ncol =</span> <span class="dv">2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Colon cancer (C18) mortality"</span>,
       <span class="dt">y =</span> <span class="st">"Deaths per 100 000"</span>)</code></pre></div>
<p><img src="colo_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can see that colon cancer deaths have shown considerable increase in 80-84 age group in men, whereas mortality among women has remained pretty much the same.</p>
</div>
<div id="incidence-versus-mortality" class="section level2">
<h2 class="hasAnchor">
<a href="#incidence-versus-mortality" class="anchor"></a>Incidence versus mortality</h2>
<p>Cancer mortality can be considered as a proxy to treatment efficacy. Therefore, let’s put these two datasets side by side to get better visual at the gap between morbidity and mortality, and how deadly this disease really is in Estonia.</p>
<p>First, we need to merge incidence and mortality datasets:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c18 &lt;-<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(
  colo <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>Site) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">incidence =</span> value), 
  colo_mort <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span><span class="st">`</span><span class="dt">Cause of death</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">mortality =</span> value)
  ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(incidence <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)
c18
<span class="co">#&gt; # A tibble: 580 x 5</span>
<span class="co">#&gt;    Year  Sex   `Age group` incidence mortality</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2001  Men   30-34            2.10      0   </span>
<span class="co">#&gt;  2 2001  Men   35-39            4.19      0   </span>
<span class="co">#&gt;  3 2001  Men   40-44           12.1       2.02</span>
<span class="co">#&gt;  4 2001  Men   45-49           10.8       6.47</span>
<span class="co">#&gt;  5 2001  Men   50-54           35.6       9.49</span>
<span class="co">#&gt;  6 2001  Men   55-59           22.0      18.8 </span>
<span class="co">#&gt;  7 2001  Men   60-64           64.9      45.1 </span>
<span class="co">#&gt;  8 2001  Men   65-69          146        65.8 </span>
<span class="co">#&gt;  9 2001  Men   70-74          214        84.6 </span>
<span class="co">#&gt; 10 2001  Men   75-79          243       113   </span>
<span class="co">#&gt; # ... with 570 more rows</span></code></pre></div>
<p>Now we can plot colon cancer incidence versus mortality, but first we want to gather incidence and mortality values into common column for easier plot setup:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c18 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">Year =</span> <span class="kw">as.numeric</span>(Year)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(key, value, <span class="op">-</span><span class="kw">c</span>(<span class="st">"Year"</span>, <span class="st">"Sex"</span>, <span class="st">"Age group"</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(Year, value, <span class="dt">color =</span> key)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_grid">facet_grid</a></span>(Sex <span class="op">~</span><span class="st"> `</span><span class="dt">Age group</span><span class="st">`</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_viridis">scale_color_viridis_d</a></span>(<span class="dt">direction =</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">axis.text.x =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/element">element_text</a></span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">6</span>),
        <span class="dt">legend.title =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/element">element_blank</a></span>(),
        <span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">y =</span> <span class="st">"Incidence vs. mortality per 100000"</span>)</code></pre></div>
<p><img src="colo_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<p>Ok, this is how working with TAI data basically looks like – find your table and download it, whereas it’s advisable to compare downloaded table to the one available on TAI webpage. Downloaded tables may need lot of cleaning (e.g. to get rid of summary data rows), pay attention to variable names which are nicely human readable but contain whitespace, may contain apostrophes.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#download-list-of-available-datasets">Download list of available datasets</a></li>
      <li><a href="#cancer-incidence">Cancer incidence</a></li>
      <li><a href="#cancer-mortality">Cancer mortality</a></li>
      <li><a href="#incidence-versus-mortality">Incidence versus mortality</a></li>
      <li><a href="#summary">Summary</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Taavi Päll.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
